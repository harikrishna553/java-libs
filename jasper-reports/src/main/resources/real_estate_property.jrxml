<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports 
              http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" 
              name="real_estate_property" pageWidth="842" pageHeight="595" 
              orientation="Landscape" columnWidth="782" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">

    <!-- Parameters -->
    <parameter name="REPORT_TITLE" class="java.lang.String" isForPrompting="false"/>
    <parameter name="AGENCY_NAME" class="java.lang.String" isForPrompting="false"/>
    <parameter name="REPORT_DATE" class="java.util.Date" isForPrompting="false"/>
    <parameter name="BROKER" class="java.lang.String" isForPrompting="false"/>
    <parameter name="TOTAL_LISTINGS" class="java.lang.Integer" isForPrompting="false"/>
    <parameter name="AVERAGE_PRICE" class="java.math.BigDecimal" isForPrompting="false"/>
    <parameter name="TOTAL_VALUE" class="java.math.BigDecimal" isForPrompting="false"/>

    <!-- Fields -->
    <field name="listingId" class="java.lang.String"/>
    <field name="fullAddress" class="java.lang.String"/>
    <field name="propertyType" class="java.lang.String"/>
    <field name="bedrooms" class="java.lang.Integer"/>
    <field name="bathrooms" class="java.lang.Integer"/>
    <field name="squareFootage" class="java.lang.Integer"/>
    <field name="lotSize" class="java.math.BigDecimal"/>
    <field name="yearBuilt" class="java.lang.Integer"/>
    <field name="listPrice" class="java.math.BigDecimal"/>
    <field name="pricePerSqFt" class="java.math.BigDecimal"/>
    <field name="status" class="java.lang.String"/>
    <field name="listingDate" class="java.util.Date"/>
    <field name="daysOnMarket" class="java.lang.Integer"/>
    <field name="agent" class="java.lang.String"/>
    <field name="description" class="java.lang.String"/>
    <field name="features" class="java.lang.String"/>
    <field name="estimatedTaxes" class="java.math.BigDecimal"/>
    <field name="schoolDistrict" class="java.lang.String"/>

    <!-- Variables -->
    <variable name="TotalListings" class="java.lang.Integer" calculation="Count">
        <variableExpression><![CDATA[$F{listingId}]]></variableExpression>
    </variable>
    
    <variable name="AveragePrice" class="java.math.BigDecimal" calculation="Average">
        <variableExpression><![CDATA[$F{listPrice}]]></variableExpression>
    </variable>
    
    <variable name="TotalValue" class="java.math.BigDecimal" calculation="Sum">
        <variableExpression><![CDATA[$F{listPrice}]]></variableExpression>
    </variable>

    <!-- Group by Property Type -->
    <group name="PropertyTypeGroup" isStartNewPage="false" isStartNewColumn="false" isResetPageNumber="false" isReprintHeaderOnEachPage="false">
        <groupExpression><![CDATA[$F{propertyType}]]></groupExpression>
        <groupHeader>
            <band height="35">
                <rectangle>
                    <reportElement x="0" y="5" width="782" height="25"  backcolor="#4472C4"/>
                </rectangle>
                <textField>
                    <reportElement x="15" y="10" width="300" height="15" />
                    <textElement>
                        <font fontName="Arial" size="12" isBold="true"/>
                    </textElement>
                    <textFieldExpression><![CDATA["Property Type: " + $F{propertyType}]]></textFieldExpression>
                </textField>
            </band>
        </groupHeader>
        <groupFooter>
            <band height="15"/>
        </groupFooter>
    </group>

    <!-- Page Header -->
    <pageHeader>
        <band height="140">
            <!-- Header Background -->
            <rectangle>
                <reportElement x="0" y="0" width="782" height="90"  backcolor="#2F5597"/>
            </rectangle>
            
            <!-- Agency Name -->
            <textField>
                <reportElement x="30" y="15" width="722" height="25" />
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="20" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{AGENCY_NAME}]]></textFieldExpression>
            </textField>
            
            <!-- Report Title -->
            <textField>
                <reportElement x="30" y="45" width="722" height="20" />
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="16" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{REPORT_TITLE}]]></textFieldExpression>
            </textField>
            
            <!-- Broker Information -->
            <textField>
                <reportElement x="30" y="70" width="722" height="15" />
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="10"/>
                </textElement>
                <textFieldExpression><![CDATA["Licensed Broker: " + $P{BROKER}]]></textFieldExpression>
            </textField>
            
            <!-- Report Statistics -->
            <rectangle>
                <reportElement x="0" y="95" width="782" height="40"  backcolor="#F2F2F2"/>
            </rectangle>
            
            <textField>
                <reportElement x="20" y="100" width="200" height="15"/>
                <textElement>
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Total Listings: " + $P{TOTAL_LISTINGS}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="250" y="100" width="250" height="15"/>
                <textElement>
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Average Price: $" + new java.text.DecimalFormat("#,##0").format($P{AVERAGE_PRICE})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="530" y="100" width="250" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Total Portfolio Value: $" + new java.text.DecimalFormat("#,##0").format($P{TOTAL_VALUE})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="530" y="115" width="250" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="9"/>
                </textElement>
                <textFieldExpression><![CDATA["Report Generated: " + new java.text.SimpleDateFormat("MMMM dd, yyyy 'at' HH:mm").format($P{REPORT_DATE})]]></textFieldExpression>
            </textField>
        </band>
    </pageHeader>

    <!-- Column Header -->
    <columnHeader>
        <band height="35">
            <rectangle>
                <reportElement x="0" y="5" width="782" height="25"  backcolor="#D9D9D9"/>
            </rectangle>
            
            <staticText>
                <reportElement x="5" y="10" width="80" height="15"/>
                <textElement>
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Listing ID]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="90" y="10" width="180" height="15"/>
                <textElement>
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Property Address]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="275" y="10" width="40" height="15"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Bed/Bath]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="320" y="10" width="50" height="15"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Sq Ft]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="375" y="10" width="40" height="15"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Year]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="420" y="10" width="70" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[List Price]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="495" y="10" width="50" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[$/Sq Ft]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="550" y="10" width="50" height="15"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Status]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="605" y="10" width="40" height="15"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Days]]></text>
            </staticText>
            
            <staticText>
                <reportElement x="650" y="10" width="130" height="15"/>
                <textElement>
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <text><![CDATA[Agent]]></text>
            </staticText>
        </band>
    </columnHeader>

    <!-- Detail Band -->
    <detail>
        <band height="70">
            <!-- Alternating Row Background -->
            <rectangle>
                <reportElement x="0" y="0" width="782" height="65" backcolor="#F9F9F9">
                    <printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 == 0]]></printWhenExpression>
                </reportElement>
                <graphicElement>
                    <pen lineColor="#F9F9F9"/>
                </graphicElement>
            </rectangle>
            
            <!-- Basic Property Information -->
            <textField>
                <reportElement x="5" y="5" width="80" height="12"/>
                <textElement>
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{listingId}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="90" y="5" width="180" height="12"/>
                <textElement>
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{fullAddress}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="275" y="5" width="40" height="12"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{bedrooms} + "/" + $F{bathrooms}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="320" y="5" width="50" height="12"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new java.text.DecimalFormat("#,##0").format($F{squareFootage})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="375" y="5" width="40" height="12"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{yearBuilt}]]></textFieldExpression>
            </textField>
            
            <!-- Price with Conditional Formatting -->
            <textField>
                <reportElement x="420" y="5" width="70" height="12" >
                    <printWhenExpression><![CDATA[$F{listPrice}.compareTo(new java.math.BigDecimal("500000")) >= 0]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["$" + new java.text.DecimalFormat("#,##0").format($F{listPrice})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="420" y="5" width="70" height="12">
                    <printWhenExpression><![CDATA[$F{listPrice}.compareTo(new java.math.BigDecimal("500000")) < 0]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["$" + new java.text.DecimalFormat("#,##0").format($F{listPrice})]]></textFieldExpression>
            </textField>
            
            <!-- Price per Sq Ft -->
            <textField>
                <reportElement x="495" y="5" width="50" height="12"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["$" + new java.text.DecimalFormat("#0").format($F{pricePerSqFt})]]></textFieldExpression>
            </textField>
            
            <!-- Status with Color Coding -->
            <textField>
                <reportElement x="550" y="5" width="50" height="12" >
                    <printWhenExpression><![CDATA[$F{status}.equals("Active")]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="550" y="5" width="50" height="12" >
                    <printWhenExpression><![CDATA[$F{status}.equals("Pending")]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="550" y="5" width="50" height="12" >
                    <printWhenExpression><![CDATA[$F{status}.equals("Sold")]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="550" y="5" width="50" height="12" >
                    <printWhenExpression><![CDATA[$F{status}.equals("Withdrawn")]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
            </textField>
            
            <!-- Days on Market with Alert -->
            <textField>
                <reportElement x="605" y="5" width="40" height="12" >
                    <printWhenExpression><![CDATA[$F{daysOnMarket} > 90]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{daysOnMarket}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="605" y="5" width="40" height="12">
                    <printWhenExpression><![CDATA[$F{daysOnMarket} <= 90]]></printWhenExpression>
                </reportElement>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{daysOnMarket}]]></textFieldExpression>
            </textField>
            
            <!-- Agent -->
            <textField>
                <reportElement x="650" y="5" width="130" height="12"/>
                <textElement>
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{agent}]]></textFieldExpression>
            </textField>
            
            <!-- Additional Details Row -->
            <textField>
                <reportElement x="90" y="20" width="100" height="10"/>
                <textElement>
                    <font fontName="Arial" size="7" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Lot: " + new java.text.DecimalFormat("#0.00").format($F{lotSize}) + " acres"]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="200" y="20" width="150" height="10"/>
                <textElement>
                    <font fontName="Arial" size="7" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["School District: " + $F{schoolDistrict}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="360" y="20" width="130" height="10"/>
                <textElement>
                    <font fontName="Arial" size="7" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Listed: " + new java.text.SimpleDateFormat("MM/dd/yyyy").format($F{listingDate})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="500" y="20" width="120" height="10"/>
                <textElement>
                    <font fontName="Arial" size="7" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Est. Taxes: $" + new java.text.DecimalFormat("#,##0").format($F{estimatedTaxes}) + "/year"]]></textFieldExpression>
            </textField>
            
            <!-- Features -->
            <textField isStretchWithOverflow="true">
                <reportElement x="5" y="33" width="775" height="12" isRemoveLineWhenBlank="true"/>
                <textElement>
                    <font fontName="Arial" size="7" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Features: " + $F{features}]]></textFieldExpression>
            </textField>
            
            <!-- Description -->
            <textField isStretchWithOverflow="true">
                <reportElement x="5" y="48" width="775" height="15" isRemoveLineWhenBlank="true"/>
                <textElement>
                    <font fontName="Arial" size="7"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{description}]]></textFieldExpression>
            </textField>
            
            <!-- Separator Line -->
            <line>
                <reportElement x="0" y="65" width="782" height="1" />
            </line>
        </band>
    </detail>

    <!-- Summary Footer -->
    <summary>
        <band height="80">
            <rectangle>
                <reportElement x="0" y="10" width="782" height="60"  backcolor="#E8F1FF"/>
            </rectangle>
            
            <staticText>
                <reportElement x="20" y="20" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="14" isBold="true" isUnderline="true"/>
                </textElement>
                <text><![CDATA[PORTFOLIO SUMMARY]]></text>
            </staticText>
            
            <!-- Summary Statistics -->
            <textField>
                <reportElement x="20" y="45" width="180" height="15"/>
                <textElement>
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Total Property Listings: " + $V{TotalListings}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="220" y="45" width="200" height="15"/>
                <textElement>
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Average List Price: $" + new java.text.DecimalFormat("#,##0").format($V{AveragePrice})]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="440" y="45" width="200" height="15"/>
                <textElement>
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Total Portfolio Value: $" + new java.text.DecimalFormat("#,##0").format($V{TotalValue})]]></textFieldExpression>
            </textField>
            
            <!-- Contact Information -->
            <staticText>
                <reportElement x="650" y="25" width="130" height="35"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8" isItalic="true"/>
                </textElement>
                <text><![CDATA[For more information, contact:
Prime Realty Group
Phone: (555) 123-4567
Email: info@primerealty.com]]></text>
            </staticText>
        </band>
    </summary>

    <!-- No Data -->
    <noData>
        <band height="50">
            <staticText>
                <reportElement x="0" y="20" width="782" height="20"/>
                <textElement textAlignment="Center">
                    <font size="12"/>
                </textElement>
                <text><![CDATA[No property data available]]></text>
            </staticText>
        </band>
    </noData>

    <!-- Page Footer -->
    <pageFooter>
        <band height="25">
            <line>
                <reportElement x="0" y="5" width="782" height="1" />
            </line>
            
            <textField>
                <reportElement x="0" y="10" width="300" height="15"/>
                <textElement>
                    <font fontName="Arial" size="8" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Prime Realty Group - Property Listings Report"]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="500" y="10" width="200" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["Generated on " + new java.text.SimpleDateFormat("MM/dd/yyyy").format(new java.util.Date())]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="710" y="10" width="40" height="15"/>
                <textElement textAlignment="Right">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
            </textField>
            
            <textField evaluationTime="Report">
                <reportElement x="750" y="10" width="32" height="15"/>
                <textElement>
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
            </textField>
        </band>
    </pageFooter>
</jasperReport>
